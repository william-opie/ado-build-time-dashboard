<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Azure DevOps Pipeline Runtime Dashboard</title>
    <link
      rel="icon"
      href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0%200%2064%2064'%3E%3Crect width='64' height='64' rx='12' fill='%232563eb'/%3E%3Cpath d='M20%2032h24' stroke='white' stroke-width='6' stroke-linecap='round'/%3E%3Cpath d='M20%2020l12%2012-12%2012' stroke='white' stroke-width='6' stroke-linecap='round' fill='none'/%3E%3C/svg%3E"
    />
    <link rel="stylesheet" href="/static/css/styles.css" />
  </head>
  <body data-default-days="{{ defaults.days }}" data-default-top="{{ defaults.top }}">
    <header>
      <h1>Azure DevOps Pipeline Runtime Dashboard</h1>
      <button id="themeToggle" type="button" aria-pressed="false">ðŸŒ™</button>
    </header>

    <section class="card">
      <form id="filters" aria-label="Build filters">
        <label>
          Branch
          <input id="branchInput" name="branch" type="text" placeholder="main or release/*" />
        </label>
        <label>
          Pipeline
          <input
            id="pipelineFilter"
            name="pipeline"
            type="search"
            placeholder="Filter by pipeline"
            autocomplete="off"
          />
        </label>
        <label class="label--compact">
          Lookback (days)
          <input id="daysInput" name="days" type="number" min="1" max="365" required />
        </label>
        <label class="label--compact">
          Max builds
          <input id="topInput" name="top" type="number" min="1" max="1000" required />
        </label>
        <label class="label--compact">
          Page size
          <input id="pageSizeInput" name="pageSize" type="number" min="10" max="200" value="50" />
        </label>
        <label>
          Timezone
          <select id="timezoneSelect" name="timezone_name" aria-label="Timezone preference"></select>
        </label>
        <div class="status-filter" id="statusFilter">
          <span class="status-label">Status</span>
          <button
            type="button"
            class="status-toggle"
            id="statusToggle"
            aria-haspopup="true"
            aria-expanded="false"
          >
            <span id="statusSelectionLabel">All statuses</span>
            <span class="chevron" aria-hidden="true">â–¾</span>
          </button>
          <div class="status-options" role="group" aria-label="Status filters">
            <label class="status-option">
              <input type="checkbox" name="results" value="succeeded" checked />
              Succeeded
            </label>
            <label class="status-option">
              <input type="checkbox" name="results" value="failed" checked />
              Failed
            </label>
            <label class="status-option">
              <input type="checkbox" name="results" value="partiallySucceeded" checked />
              Partially Succeeded
            </label>
            <label class="status-option">
              <input type="checkbox" name="results" value="canceled" checked />
              Canceled
            </label>
          </div>
        </div>
      </form>
      <div class="summary" aria-live="polite" id="summary"></div>
      <div class="error" role="alert" id="errorBanner" hidden></div>
    </section>

    <section class="card" aria-live="polite">
      <div class="table-wrapper">
        <table id="buildsTable">
          <thead>
            <tr>
              <th scope="col">Pipeline</th>
              <th scope="col">Branch</th>
              <th scope="col">Build #</th>
              <th scope="col">Status</th>
              <th scope="col">Start Time</th>
              <th scope="col">Duration</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
      <div class="spinner" id="loadingSpinner" role="status" aria-live="polite" hidden>
        <span class="sr-only">Loading buildsâ€¦</span>
      </div>
    </section>

    <script src="/static/js/dashboard.js" type="module"></script>
  </body>
</html>
